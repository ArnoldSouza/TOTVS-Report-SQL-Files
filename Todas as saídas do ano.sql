DECLARE @dates TABLE(datas datetime)    
DECLARE @dateFrom datetime
DECLARE @dateTo datetime

SET @dateFrom = '2017/19/03'
SET @dateTo = '2018/19/03'

WHILE(@dateFrom < @dateTo)
BEGIN
   SELECT @dateFrom = DATEADD(day, 1,@dateFrom)
   INSERT INTO @dates 
   SELECT @dateFrom
END

SELECT 
	CAST(DATES.datas as date) AS DATAS,
	ISNULL(SAIDA.QUANTIDADE,0) AS QTD
FROM @dates AS DATES
LEFT JOIN (
			SELECT
				SD3010.D3_EMISSAO AS DT_EMISSAO, 
				SUM(SD3010.D3_QUANT*-1) AS 'QUANTIDADE' 
			FROM PROTHEUS.dbo.SD3010 SD3010 
			WHERE
				(SD3010.D_E_L_E_T_<>'*') AND
				(LEFT(SD3010.D3_CF,2) = 'RE') AND
				(SD3010.D3_ESTORNO='') AND
				(SD3010.D3_TM<>'999' AND SD3010.D3_TM<>'503' AND SD3010.D3_TM<>'504') AND
				((SD3010.D3_EMISSAO>='20170320') AND (SD3010.D3_EMISSAO<='20180319')) AND
				SD3010.D3_FILIAL = '07' AND
				SD3010.D3_LOCAL IN ('40') AND
				SD3010.D3_COD = '01310015'
			GROUP BY 
				SD3010.D3_EMISSAO
			)  AS SAIDA ON SAIDA.DT_EMISSAO = DATES.datas