SELECT 
	SC7010.C7_FILIAL AS 'FILIAL', 
	SC7010.C7_ITEM AS 'ITEM', 
	SC7010.C7_PRODUTO AS 'PRODUTO', 
	SB1010.B1_GRUPO AS 'COD GRUPO',
	RTRIM(SBM010.BM_DESC) AS 'DESCRIÇÃO DE GRUPO',
	SC7010.C7_UM AS 'UND', 
	SC7010.C7_QUANT AS 'QUANTIDADE', 
	SC7010.C7_PRECO AS 'PREÇO', 
	SC7010.C7_TOTAL AS 'TOTAL', 
	SC7010.C7_NUMSC AS 'NUM PC', 
	SC7010.C7_ITEMSC AS 'ITEM PC', 
	CAST(SC7010.C7_DATPRF AS DATETIME) AS 'DATA DE ENTREGA',
	SC7010.C7_LOCAL AS 'ARMAZÉM', 
	Z01010.Z01_DESC AS 'DESCRIÇÃO ARMAZÉM',
	SC7010.C7_OBS AS 'OBSERVAÇÃO', 
	SC7010.C7_FORNECE AS 'FORNECEDOR',
	SC7010.C7_NOMFOR AS 'NOME FORNECEDOR',
	SC7010.C7_CC AS 'CENTRO DE CUSTO',
	RTRIM(CTT010.CTT_DESC01) AS 'DESCRIÇÃO CENTRO DE CUSTO', 
	SC7010.C7_COND AS 'CONDIÇÃO', 
	SC7010.C7_FILENT AS 'FILIAL DE ENTREGA', 
	CAST(SC7010.C7_EMISSAO AS DATETIME) AS 'EMISSÃO',
	SC7010.C7_NUM AS 'NUM PC', 
	SC7010.C7_QUJE AS 'QUANTIDADE ENTREGUE', 
	SC7010.C7_DESCRI AS 'DESCRIÇÃO PRODUTO', 
	SC7010.C7_RESIDUO AS 'RESÍDUO', 
	SC7010.C7_QTDACLA AS 'QUANT A CLA', 
	SC7010.C7_CONAPRO AS 'APROV', 
	SC7010.C7_USER AS 'COD DE USUARIO', 
	SY1010.Y1_NOME AS 'NOME COMPRADOR',
	SC7010.C7_CLVL AS 'OBRA',
	RTRIM(CTH010.CTH_DESC01) AS 'DESCRICAO DE OBRA',
	SC7010.C7_ALTUSR AS 'USUARIO ALTERAÇÃO', 
	Case RTrim(Coalesce(SC7010.C7_ALTDATA,'')) WHEN ''  THEN Null ELSE convert(datetime, SC7010.C7_ALTDATA, 112)END AS 'DATA DE ALTERAÇÃO',
	SC7010.C7_ALTMOT AS 'MOTIVO DE ALTERAÇÃO',
	Case RTrim(Coalesce(SC7010.C7_DTLIB1,'')) WHEN ''  THEN Null ELSE convert(datetime, SC7010.C7_DTLIB1, 112)END AS 'LIBERADO1',
	Case RTrim(Coalesce(SC7010.C7_DTLIB2,'')) WHEN ''  THEN Null ELSE convert(datetime, SC7010.C7_DTLIB2, 112)END AS 'LIBERADO2',
	Case RTrim(Coalesce(SC7010.C7_DTLIB3,'')) WHEN ''  THEN Null ELSE convert(datetime, SC7010.C7_DTLIB3, 112)END AS 'LIBERADO3',
	Case RTrim(Coalesce(SC7010.C7_DTLIB4,'')) WHEN ''  THEN Null ELSE convert(datetime, SC7010.C7_DTLIB4, 112)END AS 'LIBERADO4',
	Case RTrim(Coalesce(SC7010.C7_DTLIB5,'')) WHEN ''  THEN Null ELSE convert(datetime, SC7010.C7_DTLIB5, 112)END AS 'LIBERADO5',
	Case RTrim(Coalesce(SC7010.C7_DTLIB6,'')) WHEN ''  THEN Null ELSE convert(datetime, SC7010.C7_DTLIB6, 112)END AS 'LIBERADO6',
	Case RTrim(Coalesce(SC7010.C7_DTLIB7,'')) WHEN ''  THEN Null ELSE convert(datetime, SC7010.C7_DTLIB7, 112)END AS 'LIBERADO7',
	SC7010.C7_MOTIVO AS 'MOTIVO DE REJEIÇÃO', 
	SC7010.C7_QUJE+SC7010.C7_QTDACLA AS 'QUANTIDADE RECEBIDA',
	Case WHEN SC7010.C7_CC = '         ' THEN 'ESTOQUE' ELSE 'APLICAÇÃO DIRETA' END AS 'TIPO DE COMPRA',
	Case WHEN SC7010.C7_CLVL = '         ' THEN 'NÃO' ELSE 'SIM' END AS 'POSSUI OBRA?'
	
FROM PROTHEUS.dbo.SC7010 SC7010
	--CARREGAR DADOS DE PRODUTOS 
	LEFT OUTER JOIN PROTHEUS.dbo.SB1010 SB1010 ON SC7010.C7_PRODUTO=SB1010.B1_COD
	--CARREGAR DADOS DE GRUPOS
	LEFT OUTER JOIN PROTHEUS.dbo.SBM010 SBM010 ON SB1010.B1_GRUPO=SBM010.BM_GRUPO
	--CARREGAR DADOS DE ARMAZÉM
	LEFT OUTER JOIN PROTHEUS.dbo.Z01010 Z01010 ON SC7010.C7_FILIAL=Z01010.Z01_FILIAL AND SC7010.C7_LOCAL=Z01010.Z01_COD
	--CARREGAR DADOS DE CENTRO DE CUSTO
	LEFT OUTER JOIN PROTHEUS.dbo.CTT010 CTT010 ON SC7010.C7_CC=CTT010.CTT_CUSTO
	--CARREGAR DADOS DE COMPRADOR
	LEFT OUTER JOIN PROTHEUS.dbo.SY1010 SY1010 ON SC7010.C7_USER=SY1010.Y1_USER
	--CARREGAR DADOS OBRA 
	LEFT OUTER JOIN PROTHEUS.dbo.CTH010 CTH010 ON SC7010.C7_CLVL=CTH010.CTH_CLVL
	
WHERE
(
	((SC7010.C7_FILIAL='02') AND (SC7010.C7_CONAPRO='L') AND (SC7010.D_E_L_E_T_<>'*') AND (SC7010.C7_LOCAL='19'))
	OR 
	((SC7010.C7_FILIAL='02') AND (SC7010.C7_CONAPRO='L') AND (SC7010.D_E_L_E_T_<>'*') AND (SC7010.C7_LOCAL='21')) 
	OR 
	((SC7010.C7_FILIAL='02') AND (SC7010.C7_CONAPRO='L') AND (SC7010.D_E_L_E_T_<>'*') AND (SC7010.C7_LOCAL='22'))
	OR 
	((SC7010.C7_FILIAL='02') AND (SC7010.C7_CONAPRO='L') AND (SC7010.D_E_L_E_T_<>'*') AND (SC7010.C7_LOCAL='31'))
	OR 
	((SC7010.C7_FILIAL='12') AND (SC7010.C7_CONAPRO='L') AND (SC7010.D_E_L_E_T_<>'*') AND (SC7010.C7_LOCAL='91'))
	OR 
	((SC7010.C7_FILIAL='12') AND (SC7010.C7_CONAPRO='L') AND (SC7010.D_E_L_E_T_<>'*') AND (SC7010.C7_LOCAL='92'))
	
) AND SC7010.C7_EMISSAO >= '20160101'