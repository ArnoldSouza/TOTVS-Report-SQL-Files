SELECT 
	SC1010.C1_FILIAL+SC1010.C1_LOCAL+' - '+Z01010.Z01_DESC AS 'DESCRIÇÃO ARMAZÉM',
	
	-- SC1010.C1_PRODUTO AS 'CODIGO', 
	-- RTRIM(SC1010.C1_DESCRI) AS 'DESCRIÇÃO',
	-- SC1010.C1_UM AS 'UND', 
	-- SC1010.C1_QUANT AS 'QTDE', 
	-- SC1010.C1_VLESTIM AS 'VAL. UND.',
	-- SC1010.C1_VTOTAL AS 'VAL TOTAL', 
	-- SC1010.C1_TOTSC AS 'VAL TOTAL SC',
	-- SC1010.C1_QUJE AS 'QTDE EM PEDIDO',
	-- (SC1010.C1_QUANT-SC1010.C1_QUJE) AS 'QTDE FALTA',
	-- (SC1010.C1_QUANT-SC1010.C1_QUJE)*SC1010.C1_VLESTIM AS 'VAL FALTA',
	-- SB1010.B1_GRUPO AS 'COD GRUPO',
	-- RTRIM(SBM010.BM_DESC) AS 'DESC GRUPO',
	-- SC1010.C1_OBS AS 'OBSERVAÇÃO', 
	-- CASE WHEN SC1010.C1_CC = '          ' THEN 'PROCESSO PARA ARMAZÉM' ELSE SC1010.C1_CC+' - '+RTRIM(CTT010.CTT_DESC01) END AS 'DESCRIÇÃO CENTRO DE CUSTO',  
	-- SC1010.C1_SOLICIT AS 'NOME SOLICITANTE SC',  
	RTRIM(SY1010.Y1_NOME) AS 'NOME COMPRADOR SC',
	-- CASE WHEN SC1010.C1_CODCOMP IN ('117','205','157','150','012','217','068','017','179') THEN 'COMPRA CORPORATIVA' ELSE 'COMPRA LOCAL'  END AS 'LOCAL DE COMPRA',
	-- RTRIM(SC1010.C1_CLVL+' - '+CTH010.CTH_DESC01) AS 'DESC OBRA/PROJETO',
	
	CASE WHEN SC1010.C1_APROV = 'B' THEN 'BLOQUEADA' ELSE 'APROVADA'  END AS 'SC APROVADA?',
	CASE WHEN SC1010.C1_CC = '          ' THEN 'PARA ARMAZÉM' ELSE 'APLICAÇÃO DIRETA' END AS 'TIPO DE COMPRA',
	SC1010.C1_NUM AS 'NUM SC', 
	SC1010.C1_ITEM AS 'ITEM', 
	CASE WHEN SC1010.C1_NUM = '      ' THEN 'NÃO ATENDIDO' ELSE 'ATENDIDO' END AS 'ATENDIDO PC',
	SC1010.C1_PEDIDO AS 'NUM PC', 
	SC1010.C1_ITEMPED AS 'ITEM PC',
	SC1010.C1_ALTMOT AS 'MOT ALTERAÇÃO',
	SC1010.C1_APROV1 AS 'APROV SC 1', 
	SC1010.C1_APROV2 AS 'APROV SC 2', 
	SC1010.C1_APROV3 AS 'APROV SC 3', 
	SC1010.C1_APROV4 AS 'APROV SC 4', 
	SC1010.C1_APROV5 AS 'APROV SC 5', 
	SC1010.C1_APROV6 AS 'APROV SC 6', 
	SC1010.C1_APROV7 AS 'APROV SC 7', 
	
	/* (SELECT SY1010.Y1_NOME FROM PROTHEUS.dbo.SY1010 SY1010 WHERE SC1010.C1_APROV1=SY1010.Y1_USER) AS 'NOME APROV 1',
	(SELECT SY1010.Y1_NOME FROM PROTHEUS.dbo.SY1010 SY1010 WHERE SC1010.C1_APROV2=SY1010.Y1_USER) AS 'NOME APROV 2',
	(SELECT SY1010.Y1_NOME FROM PROTHEUS.dbo.SY1010 SY1010 WHERE SC1010.C1_APROV3=SY1010.Y1_USER) AS 'NOME APROV 3',
	(SELECT SY1010.Y1_NOME FROM PROTHEUS.dbo.SY1010 SY1010 WHERE SC1010.C1_APROV4=SY1010.Y1_USER) AS 'NOME APROV 4',
	(SELECT SY1010.Y1_NOME FROM PROTHEUS.dbo.SY1010 SY1010 WHERE SC1010.C1_APROV5=SY1010.Y1_USER) AS 'NOME APROV 5',
	(SELECT SY1010.Y1_NOME FROM PROTHEUS.dbo.SY1010 SY1010 WHERE SC1010.C1_APROV6=SY1010.Y1_USER) AS 'NOME APROV 6',
	(SELECT SY1010.Y1_NOME FROM PROTHEUS.dbo.SY1010 SY1010 WHERE SC1010.C1_APROV7=SY1010.Y1_USER) AS 'NOME APROV 7', */
	
	Case RTrim(Coalesce(SC1010.C1_EMISSAO,'')) WHEN ''  THEN Null ELSE convert(datetime, SC1010.C1_EMISSAO, 112)END AS 'EMISSÃO SC',
	Case RTrim(Coalesce(SC1010.C1_ALTDATA,'')) WHEN ''  THEN Null ELSE convert(datetime, SC1010.C1_ALTDATA, 112)END AS 'DT ALTERAÇÃO SC',
	
	Case RTrim(Coalesce(SC1010.C1_DATPRF,'')) WHEN ''  THEN Null ELSE convert(datetime, SC1010.C1_DATPRF, 112)END AS 'DT NECESSIDADE SC',
	
	Case RTrim(Coalesce(SC1010.C1_DTLIB1,'')) WHEN ''  THEN Null ELSE convert(datetime, SC1010.C1_DTLIB1, 112)END AS 'DT LIB SC 1',
	Case RTrim(Coalesce(SC1010.C1_DTLIB2,'')) WHEN ''  THEN Null ELSE convert(datetime, SC1010.C1_DTLIB2, 112)END AS 'DT LIB SC 2',
	Case RTrim(Coalesce(SC1010.C1_DTLIB3,'')) WHEN ''  THEN Null ELSE convert(datetime, SC1010.C1_DTLIB3, 112)END AS 'DT LIB SC 3',
	Case RTrim(Coalesce(SC1010.C1_DTLIB4,'')) WHEN ''  THEN Null ELSE convert(datetime, SC1010.C1_DTLIB4, 112)END AS 'DT LIB SC 4',
	Case RTrim(Coalesce(SC1010.C1_DTLIB5,'')) WHEN ''  THEN Null ELSE convert(datetime, SC1010.C1_DTLIB5, 112)END AS 'DT LIB SC 5',
	Case RTrim(Coalesce(SC1010.C1_DTLIB6,'')) WHEN ''  THEN Null ELSE convert(datetime, SC1010.C1_DTLIB6, 112)END AS 'DT LIB SC 6',
	Case RTrim(Coalesce(SC1010.C1_DTLIB7,'')) WHEN ''  THEN Null ELSE convert(datetime, SC1010.C1_DTLIB7, 112)END AS 'DT LIB SC 7',
	
	SC7010.C7_APROV1 AS 'APROV PC 1', 
	SC7010.C7_APROV2 AS 'APROV PC 2', 
	SC7010.C7_APROV3 AS 'APROV PC 3', 
	SC7010.C7_APROV4 AS 'APROV PC 4', 
	SC7010.C7_APROV5 AS 'APROV PC 5', 
	SC7010.C7_APROV6 AS 'APROV PC 6', 
	SC7010.C7_APROV7 AS 'APROV PC 7', 
	
	Case RTrim(Coalesce(SC7010.C7_EMISSAO,'')) WHEN ''  THEN Null ELSE convert(datetime, SC7010.C7_EMISSAO, 112)END AS 'EMISSÃO PC',
	Case RTrim(Coalesce(SC7010.C7_ALTDATA,'')) WHEN ''  THEN Null ELSE convert(datetime, SC7010.C7_ALTDATA, 112)END AS 'DT ALTERAÇÃO PC',
	
	Case RTrim(Coalesce(SC7010.C7_DATPRF,'')) WHEN ''  THEN Null ELSE convert(datetime, SC7010.C7_DATPRF, 112)END AS 'DT ENTREGA PC',
	
	Case RTrim(Coalesce(SC7010.C7_DTLIB1,'')) WHEN ''  THEN Null ELSE convert(datetime, SC7010.C7_DTLIB1, 112)END AS 'DT LIB PC 1',
	Case RTrim(Coalesce(SC7010.C7_DTLIB2,'')) WHEN ''  THEN Null ELSE convert(datetime, SC7010.C7_DTLIB2, 112)END AS 'DT LIB PC 2',
	Case RTrim(Coalesce(SC7010.C7_DTLIB3,'')) WHEN ''  THEN Null ELSE convert(datetime, SC7010.C7_DTLIB3, 112)END AS 'DT LIB PC 3',
	Case RTrim(Coalesce(SC7010.C7_DTLIB4,'')) WHEN ''  THEN Null ELSE convert(datetime, SC7010.C7_DTLIB4, 112)END AS 'DT LIB PC 4',
	Case RTrim(Coalesce(SC7010.C7_DTLIB5,'')) WHEN ''  THEN Null ELSE convert(datetime, SC7010.C7_DTLIB5, 112)END AS 'DT LIB PC 5',
	Case RTrim(Coalesce(SC7010.C7_DTLIB6,'')) WHEN ''  THEN Null ELSE convert(datetime, SC7010.C7_DTLIB6, 112)END AS 'DT LIB PC 6',
	Case RTrim(Coalesce(SC7010.C7_DTLIB7,'')) WHEN ''  THEN Null ELSE convert(datetime, SC7010.C7_DTLIB7, 112)END AS 'DT LIB PC 7',
	
	(
	SELECT MAX (SF1010.F1_DTINCL)
	FROM PROTHEUS.dbo.SD1010 SD1010
		LEFT JOIN PROTHEUS.dbo.SF1010 SF1010 ON (SD1010.D1_DOC+SD1010.D1_SERIE+SD1010.D1_FORNECE+SD1010.D1_LOJA)=(SF1010.F1_DOC+SF1010.F1_SERIE+SF1010.F1_FORNECE+SF1010.F1_LOJA)
	WHERE (SC1010.C1_PEDIDO+SC1010.C1_ITEMPED)=(SD1010.D1_PEDIDO+SD1010.D1_ITEMPC)
	) AS 'DATA DE RECEBIMENTO',
	
	SC7010.C7_RESIDUO as residuo,
	
	CASE WHEN SC7010.C7_RESIDUO=' ' THEN 'NÃO' ELSE 'SIM' END AS 'PC ELIMINADO RESÍDUO?',
	
	CASE WHEN SC7010.C7_CONAPRO = 'L' THEN 'APROVADO' ELSE 'BLOQUEADO' END AS 'SITUAÇÃO PC'
	
FROM PROTHEUS.dbo.SC1010 SC1010
	LEFT JOIN PROTHEUS.dbo.Z01010 Z01010 ON Z01010.Z01_CODGER = (SC1010.C1_FILIAL + SC1010.C1_LOCAL)
	LEFT JOIN PROTHEUS.dbo.CTT010 CTT010 ON SC1010.C1_CC=CTT010.CTT_CUSTO
	LEFT JOIN PROTHEUS.dbo.CT1010 CT1010 ON SC1010.C1_CONTA=CT1010.CT1_CONTA
	LEFT JOIN PROTHEUS.dbo.CTH010 CTH010 ON SC1010.C1_CLVL=CTH010.CTH_CLVL
	LEFT JOIN PROTHEUS.dbo.CTD010 CTD010 ON SC1010.C1_ITEMCTA=CTD010.CTD_ITEM
	LEFT JOIN PROTHEUS.dbo.SA2010 SA2010 ON SC1010.C1_FORNECE=SA2010.A2_COD
	LEFT JOIN PROTHEUS.dbo.SY1010 SY1010 ON SC1010.C1_CODCOMP=SY1010.Y1_COD
	LEFT JOIN PROTHEUS.dbo.SB1010 SB1010 ON SC1010.C1_PRODUTO=SB1010.B1_COD
	LEFT JOIN PROTHEUS.dbo.SBM010 SBM010 ON SB1010.B1_GRUPO=SBM010.BM_GRUPO
	LEFT JOIN PROTHEUS.dbo.SC7010 SC7010 ON (SC1010.C1_NUM+SC1010.C1_ITEM)=(SC7010.C7_NUMSC+SC7010.C7_ITEMSC)
	
WHERE
	(SC1010.D_E_L_E_T_<>'*') AND
	(SC1010.C1_EMISSAO>='20160101') AND
	(SC1010.C1_RESIDUO= ' ') AND 
	--GRUPOS QUE NÃO PERTENCEM À ANÁLISE (GERALMENTE PARTENCENTES AO RH)
	
	(SB1010.B1_GRUPO NOT IN ('1060','0174','3001','3005','0702','0703','0707','0710','1024','1025','3002','3003','3007','3050','3060','0720','0752','1200','3004','1203','0700','0706','0743','0780','0781','0782','0820','0822','0823','0825','1022','1065','1202','1204','1205','1206','1208','1211','1213','1215','1219','3000','3006','3008','3054','4006','7000')) AND
	
	(SC1010.C1_APROV='L') AND 
	(SC1010.C1_FILIAL='02' AND (SC1010.C1_LOCAL='19' OR SC1010.C1_LOCAL='21' OR SC1010.C1_LOCAL='22' OR SC1010.C1_LOCAL='31'))