SELECT TOP 5000
    --MODULO DE ORIGEM NO PROTHEUS
	SE2010.E2_ORIGEM AS 'ORIGEM',

    --DADOS DO DOCUMENTO
    RTRIM(SE2010.E2_FILORIG) AS 'FILIAL ORIG',
    RTRIM(SE2010.E2_PREFIXO) AS 'PREFIXO NF',
    RTRIM(SE2010.E2_NUM) AS 'TITULO (DOC)',
    SE2010.E2_PARCELA AS 'PARCELA',
    RTRIM(SE2010.E2_TIPO) AS 'TIPO DOC',
    RTRIM(SE2010.E2_NUMBOR) AS 'NUM BORDERO',

    --IDENTIFICAÇÃO DO FORNECEDOR
    SE2010.E2_FORNECE AS 'COD FORN',
    RTRIM(SA2010.A2_NREDUZ) AS 'NOME FANTASIA',
    RTRIM(SA2010.A2_NOME) AS 'RAZAO SOCIAL',
    SE2010.E2_LOJA AS 'LOJA',

    --GRUPOS CLASSIFICADORES
    RTRIM(SE2010.E2_CCD) AS 'C CUSTO DEB',
    RTRIM(SE2010.E2_NATUREZ) AS 'NATUREZA',
    SE2010.E2_CONTAD AS 'CONTA CONTABIL',

    --BLOCO DE DATAS
    IIF(RTRIM(COALESCE(SE2010.E2_EMISSAO, '')) = '', NULL, CONVERT(DATE, SE2010.E2_EMISSAO, 112)) AS 'DT EMISSAO',
    IIF(RTRIM(COALESCE(SE2010.E2_VENCTO, '')) = '', NULL, CONVERT(DATE, SE2010.E2_VENCTO, 112)) AS 'DT VENCIMENTO',
    IIF(RTRIM(COALESCE(SE2010.E2_VENCREA, '')) = '', NULL, CONVERT(DATE, SE2010.E2_VENCREA, 112)) AS 'DT VENCIMENTO REAL',
    IIF(RTRIM(COALESCE(SE2010.E2_BAIXA, '')) = '', NULL, CONVERT(DATE, SE2010.E2_BAIXA, 112)) AS 'DT BAIXA',
    IIF(RTRIM(COALESCE(SE2010.E2_EMIS1, '')) = '', NULL, CONVERT(DATE, SE2010.E2_EMIS1, 112)) AS 'DT CONTABILIZAÇÃO',
    IIF(RTRIM(COALESCE(SE2010.E2_VENCORI, '')) = '', NULL, CONVERT(DATE, SE2010.E2_VENCORI, 112)) AS 'DT VENCIMENTO ORIGINAL',
    IIF(RTRIM(COALESCE(SE2010.E2_DTBORDE, '')) = '', NULL, CONVERT(DATE, SE2010.E2_DTBORDE, 112)) AS 'DT BORDERO',
    IIF(RTRIM(COALESCE(SE2010.E2_DATAAGE, '')) = '', NULL, CONVERT(DATE, SE2010.E2_DATAAGE, 112)) AS 'DT AGEND',
    IIF(RTRIM(COALESCE(SE2010.E2_MOVIMEN, '')) = '', NULL, CONVERT(DATE, SE2010.E2_MOVIMEN, 112)) AS 'DT ULT MOVIMENT',

    --VALORES DO TITULO
    SE2010.E2_VALOR AS 'VALOR TITULO',
    SE2010.E2_VLCRUZ AS 'VALOR',
    SE2010.E2_SALDO AS 'SALDO',
    SE2010.E2_DESCONT AS 'DESCONTO',
    SE2010.E2_JUROS AS 'JUROS',
    SE2010.E2_VALLIQ AS 'VAL LIQ BAIX',
    SE2010.E2_ACRESC AS 'ACRESCIMO',
    SE2010.E2_DECRESC AS 'DECRESCIMENTO',
    SE2010.E2_SDDECRE AS 'SALDO DECRESCIMO',

    --OBSERVAÇÕES SOBRE O LANÇAMENTO
    SE2010.E2_HIST AS 'HISTORICO',
    SE2010.E2_INFCOMP AS 'INFO COMPLEMENTAR',
    SE2010.E2_DETHIST AS 'HISTORICO',

    --INFORMAÇÕES DE FATURA
    SE2010.E2_FATPREF AS 'PREF FATURA',
    SE2010.E2_FATURA AS 'NUM FATURA',
    SE2010.E2_FLAGFAT AS 'FLAG FATURA',
    SE2010.E2_TITPAI AS 'TITULO PAI',

    SE2010.E2_LA AS 'IDENT LANC',
    SE2010.E2_IDCNAB AS 'ID CNAB',
    SE2010.E2_STATLIB AS 'LIBERADO',
    SE2010.E2_TEMDOCS AS 'POSSUI DOCS',
    SE2010.E2_USERID AS 'USUARIO'
FROM PROTHEUS.dbo.SE2010 SE2010
    LEFT JOIN PROTHEUS.dbo.SA2010 SA2010 WITH (NOLOCK) ON SE2010.E2_FORNECE=SA2010.A2_COD AND SE2010.E2_LOJA=SA2010.A2_LOJA AND SA2010.D_E_L_E_T_<>'*' --JOIN FORNECEDOR
WHERE
    SE2010.D_E_L_E_T_<>'*' --AND
    --SE2010.E2_BAIXA>='20200601'
ORDER BY
    SE2010.R_E_C_N_O_ DESC --ORGANIZA POR ULTIMAS ENTRADAS